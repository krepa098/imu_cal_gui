name: windows build

on:
    push:
        branches: [ master ]
    pull_request:
        branches: [ master ]
    release:
        types: [ published ]

jobs:
    build:
        runs-on: windows-latest

        steps:
            - uses: actions/checkout@v4

            # setup fortran compiler
            - uses: fortran-lang/setup-fortran@v1
              id: setup-fortran
              with:
                compiler: gcc
                version: 13

            - run: |
              ${{ env.FC }} ... # environment vars FC, CC, and CXX are set
              ${{ steps.setup-fortran.outputs.fc }} ... # outputs work too

            # build exe
            - name: build
              run: cargo build --release --no-default-features
              working-directory: ${{ github.workspace }}
            
            # artifact
            - uses: actions/upload-artifact@v4
              with:
                name: imu-calibration-gui-serialport.exe
                path: ${{ github.workspace }}/target/release/imu_cal_gui.exe